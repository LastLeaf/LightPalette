// Copyright 2014 LastLeaf, LICENSE: github.lastleaf.me/MIT
"use strict";var LIST_LEN=20;fw.main(function(t){var o=t.tmpl,e=o.i18n,n=$("#content").html(o.main()),i=n.find(".table"),a=lp.tableBuilder(i,{idCol:"_id"},[{id:"title",name:e("Title")},{id:"_id",name:e("Short Name"),input:"add"},{id:"description",type:"extra"}],{}).data(function(o){t.rpc("category:list",{from:o*LIST_LEN,count:LIST_LEN},function(t){a.setTotal(Math.ceil(t.total/LIST_LEN));var o=t.rows;a.set(o)},function(t){lp.backstage.showError(t)})}).setPage(0,1);a.add(function(o){t.rpc("category:create",o,function(){a.addRow(o._id,o)},function(t){lp.backstage.showError(t),a.enableAdd()})}),a.change(function(o){t.rpc("category:modify",o,function(){a.setRow(o._id,o)},function(t){lp.backstage.showError(t),a.enableModify(o._id)})}),a.remove(function(o){t.rpc("category:remove",{_id:o},function(){a.removeRow(o)},function(t){lp.backstage.showError(t),a.enableModify(o)})})});
