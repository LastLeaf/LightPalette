// Copyright 2014 LastLeaf, LICENSE: github.lastleaf.me/MIT
"use strict";fw.main(function(t){window.lp={},t.on("childLoadEnd",function(){fw.loadingLogo.disabled=!0});var o={};lp.drivers={init:function(t,e){"function"==typeof e?o[t]=e:o[t]&&o[t](e)}},lp.gravatarUrl=function(t,o,e){var n="http://www.gravatar.com/avatar/"+CryptoJS.MD5(t)+"?d="+encodeURIComponent(e||"mm");return o&&(n+="&s="+o),n},lp.register=function(o,e,n,c,i){c=c||function(){},t.rpc("/backstage/user:register",{id:o,password:CryptoJS.SHA256(o.toLowerCase()+"|"+e),email:n},c,i)},lp.login=function(o,e,n,c){n=n||function(){},t.rpc("/backstage/user:login",{id:o,password:CryptoJS.SHA256(o.toLowerCase()+"|"+e)},function(){n()!==!1&&setTimeout(function(){location.reload()},0)},c)},lp.logout=function(o,e){o=o||function(){},t.rpc("/backstage/user:logout",function(){o()!==!1&&setTimeout(function(){location.reload()},0)},e)},lp.comments={list:function(t,o,e,n){"function"==typeof o&&(n=e,e=o,o=null),fw.getPage().rpc("/backstage/comment:list",{root:"",depth:4,post:t,desc:o?"yes":""},e,n)},getReplies:function(t,o,e,n){"function"==typeof o&&(n=e,e=o,o=null),fw.getPage().rpc("/backstage/comment:list",{root:t,depth:4,post:postId,desc:o?"yes":""},e,n)},add:function(t,o,e){fw.getPage().rpc("/backstage/comment:create",t,o,e)},form:function(t,o,e,n){t.setAttribute("fw",""),t.setAttribute("action","/backstage/comment"),t.setAttribute("method","create"),fw.getPage().form(t,o,e,n)}}});
